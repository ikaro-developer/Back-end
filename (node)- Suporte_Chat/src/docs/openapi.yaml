openapi: 3.0.0
info:
  title: API Node (Express) + TypeScript + TypeORM + SQLite + MVC + Swagger + Socket.IO
  version: 1.2.0
  description: Documentação completa da API

servers:
  - url: http://localhost:3333
    description: Servidor local

tags:
  - name: Settings
  - name: Users
  - name: Messages

paths:
  /settings:
    post:
      tags:
        - Settings
      summary: Cria uma nova configuração
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - chat
              properties:
                username:
                  type: string
                  example: carlos
                chat:
                  type: boolean
                  example: true
      responses:
        201:
          description: Configuração criada com sucesso
        400:
          description: Dados inválidos
        409:
          description: Usuário já possui configuração

  /settings/{username}:
    get:
      tags:
        - Settings
      summary: Busca configuração pelo username
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Configuração encontrada
        400:
          description: Username não informado
        404:
          description: Configuração não encontrada

    put:
      tags:
        - Settings
      summary: Atualiza configuração pelo username
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - chat
              properties:
                chat:
                  type: boolean
                  example: false
      responses:
        200:
          description: Configuração atualizada com sucesso
        400:
          description: Dados inválidos
        404:
          description: Configuração não encontrada

  /users:
    post:
      tags:
        - Users
      summary: Cria um novo usuário
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  example: carlos@email.com
      responses:
        201:
          description: Usuário criado com sucesso
        400:
          description: Dados inválidos
        409:
          description: Usuário já existe

  /message:
    post:
      tags:
        - Messages
      summary: Cria uma nova mensagem
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - text
                - user_id
              properties:
                admin_id:
                  type: string
                  format: uuid
                  nullable: true
                text:
                  type: string
                  example: Olá, preciso de ajuda
                user_id:
                  type: string
                  format: uuid
      responses:
        201:
          description: Mensagem criada com sucesso
        400:
          description: Dados inválidos
        500:
          description: Erro interno do servidor

  /message/{id}:
    get:
      tags:
        - Messages
      summary: Lista mensagens por usuário
      parameters:
        - name: id
          in: path
          required: true
          description: ID do usuário (UUID)
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: Lista de mensagens do usuário
        400:
          description: ID inválido
        500:
          description: Erro interno do servidor
